<?php
/**
 * Implements hook_menu().
 * 
 * TODO: integrate with imls URLS
 * 
 */
function library_branches_menu() {
  $items = array();

  $items['edit-branches'] = array(
    'title' => 'Edit Branches',
    'description' => 'Edit branches',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('library_branches_edit_form'),
    'access callback' => TRUE
  );

  return $items;
}

function library_branches_edit_form($form, &$form_state) {
  dpm(impact_util_get_state());
  
  //drupal_add_js(drupal_get_path('module', 'library_branches') . '/library_branches_map.js');
  drupal_add_js('http://maps.google.com/maps/api/js?sensor=true', 'external');
  // Set dimensions for the map
  drupal_add_css('div#gmap{width:600px;height:300px}', 'inline');
  dpm(drupal_get_path('module', 'library_branches') . '/library_branches_map.js');
  
  $form = array();
  
  $form['state'] = array(
    '#type' => 'hidden',
    '#value' => impact_util_get_state()
  );
  $form['fscs_key'] = array(
    '#type' => 'hidden',
  );
  $form['fscs_seq'] = array(
    '#type' => 'hidden',
  );
  $form['branch_name'] = array(
    '#type' => 'textfield',
    '#title' => t('Branch Name'),
  );
  $form['address'] = array(
    '#type' => 'textfield',
    '#title' => t('Address'),
  );
  $form['city'] = array(
    '#type' => 'textfield',
    '#title' => t('City'),
  );
  $form['zip'] = array(
    '#type' => 'textfield',
    '#title' => t('Zip'),
  );
  $form['map'] = array (
    '#markup' => '<div id="gmap"></div>'
  );
  $form['latitude'] = array(
    '#type' => 'textfield',
    '#title' => t('Latitude'),
    '#attributes' => array('id' => 'lat')
  );
  $form['longitude'] = array(
    '#type' => 'textfield',
    '#title' => t('Longitude'),
    '#attributes' => array('id' => 'lon')
  );
  $form['square_feet'] = array(
    '#type' => 'textfield',
    '#title' => t('Square Feet'),
  );
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => 'Submit',
  );
  $script_loc = drupal_get_path('module', 'library_branches') . '/library_branches_map.js';
  $form['map_script'] = array ('#markup' => '<script type="text/javascript" src="' . $script_loc . '"></script>');
  
  return $form;
}